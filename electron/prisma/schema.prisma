generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  name  String?
  posts Post[]
}

model Post {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  title     String
  content   String?
  published Boolean  @default(false)
  viewCount Int      @default(0)
  author    User?    @relation(fields: [authorId], references: [id])
  authorId  Int?
}

model DBClipboard {
  id        Int                  @id @default(autoincrement())
  createdAt DateTime             @default(now())
  updatedAt DateTime             @updatedAt
  copyTime  DateTime             @default(now()) // 拷贝时间
  summary   String
  owner     DBClipboardOwner     @relation(fields: [ownerId], references: [id]) // 使用的应用程序
  ownerId   Int
  contents  DBClipboardContent[]

  @@index([summary])
}

model DBClipboardOwner {
  id         Int           @id @default(autoincrement())
  platform   String
  path       String        @unique
  name       String
  icon       String
  bundleId   String?
  clipboards DBClipboard[]

  @@index([name])
}

model DBClipboardContent {
  id          Int                        @id @default(autoincrement())
  type        String
  text        String?
  buffers     DBClipboardContentBuffer[]
  clipboard   DBClipboard?               @relation(fields: [clipboardId], references: [id])
  clipboardId Int?
}

model DBClipboardContentBuffer {
  id               Int                 @id @default(autoincrement())
  path             String
  suffix           String
  clipboardContent DBClipboardContent? @relation(fields: [bufferId], references: [id]) // 使用的应用程序
  bufferId         Int

  @@index([suffix])
}
